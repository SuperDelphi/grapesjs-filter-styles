{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@silexlabs/grapesjs-filter-styles/webpack/universalModuleDefinition","webpack://@silexlabs/grapesjs-filter-styles/webpack/bootstrap","webpack://@silexlabs/grapesjs-filter-styles/webpack/runtime/define property getters","webpack://@silexlabs/grapesjs-filter-styles/webpack/runtime/hasOwnProperty shorthand","webpack://@silexlabs/grapesjs-filter-styles/webpack/runtime/make namespace object","webpack://@silexlabs/grapesjs-filter-styles/../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@silexlabs/grapesjs-filter-styles/../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@silexlabs/grapesjs-filter-styles/../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@silexlabs/grapesjs-filter-styles/../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@silexlabs/grapesjs-filter-styles/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@silexlabs/grapesjs-filter-styles\"] = factory();\n\telse\n\t\troot[\"@silexlabs/grapesjs-filter-styles\"] = factory();\n})(typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : this), () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export default (editor, opts = {}) => {\n  editor.on('load', () => {\n    const options = {\n      ...{\n        placeholder: 'Search...',\n        appendTo: null,\n        appendBefore: null,\n      }, ...opts\n    };\n\n    const prefix = editor.Config.selectorManager.pStylePrefix;\n    const id = `${prefix}filter-styles`\n    const container = document.createElement('div')\n    container.innerHTML = `\n      <style>\n        #${id}-btn {\n          position: absolute;\n          right: 0;\n          border: none;\n          padding: 5px;\n          margin: 5px;\n          line-height: 1;\n          border-radius: 50%;\n          width: 25px;\n          height: 25px;\n          border: 1px solid;\n          z-index: 1;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          transition: opacity .15s ease;\n          cursor: pointer;\n          opacity: .75;\n        }\n        .empty #${id}-btn {\n          cursor: initial;\n          opacity: .25;\n        }\n      </style>\n\n      <button\n        id=\"${id}-btn\"\n        class=\"gjs-field gjs-sm-properties gjs-two-color\"\n        >X</button>\n      <input id=\"${id}\" type=\"text\" class=\"gjs-field gjs-sm-properties gjs-two-color\" placeholder=\"${options.placeholder}\" />\n    `\n    const tags = editor.getContainer().querySelector(`.${prefix}clm-tags`);\n    const appendBefore = typeof options.appendBefore === 'string' ? document.querySelector(options.appendBefore) : options.appendBefore\n    const appendTo = typeof options.appendTo === 'string' ? document.querySelector(options.appendTo) : options.appendTo\n    const wrapper = appendBefore ? appendBefore.parentElement : appendTo ?? tags.parentElement.parentElement\n    wrapper.insertBefore(container, appendBefore ?? tags.parentElement.parentElement.lastElementChild);\n    const input = wrapper.querySelector(`#${id}`)\n    input.onkeyup = () => refresh(editor, input, wrapper)\n    const button = wrapper.querySelector(`#${id}-btn`)\n    button.onclick = () => {\n      input.value = ''\n      refresh(editor, input, wrapper)\n    }\n    editor.on('component:selected component:styleUpdate', () => {\n      resetAll(editor)\n      setTimeout(() => refresh(editor, input, wrapper))\n    })\n  })\n}\n\n// Reset all sectors\nfunction resetAll(editor) {\n  getSectors(editor)\n    .forEach(sector => {\n      resetSector(sector)\n      sector.getProperties()\n        .forEach(property => {\n          resetProperty(property)\n        })\n    })\n}\n\n// Sectors\nconst changedSectors = new WeakMap()\nfunction showSector(sector, visible) {\n  if(!changedSectors.has(sector)) {\n    changedSectors.set(sector, {\n      sector,\n      initial: sector.isOpen(),\n    })\n  }\n  sector.setOpen(visible)\n}\nfunction resetSector(sector) {\n  const item = changedSectors.get(sector)\n  item?.sector.setOpen(item?.initial)\n  changedSectors.delete(sector)\n}\n\n// Properties\nconst changedProperties = new WeakMap()\nfunction showProperty(property, visible) {\n  if(!changedProperties.has(property)) {\n    changedProperties.set(property, {\n      property,\n      initial: property.get('visible'),\n    })\n  }\n  property.set('visible', visible)\n}\nfunction resetProperty(property) {\n  const item = changedProperties.get(property)\n  item?.property.set('visible', item?.initial)\n  changedProperties.delete(property)\n}\n\n// Filters\nfunction getSectors(editor) {\n  return editor.StyleManager.getSectors().toArray()\n    // Filter visible sectors\n    .filter(sector => sector.isVisible())\n}\nfunction getSearchableItems(editor) {\n  return getSectors(editor)\n    // Handles composite properties\n    .flatMap(sector => sector.getProperties().flatMap(property => (property.getType() === 'composite' ? property.properties.map(subprop => ({\n      sector,\n      property,\n      subprop,\n    })) : {\n      sector,\n      property,\n    })))\n    // Create a searchable field\n    .map(({ sector, property, subprop }) => ({\n      searchable: `\n        ${sector.get('name')}\n        ${property.get('name')}\n        ${property.get('options')?.map(option => option.id).join(', ') ?? ''}\n        ${subprop?.get('name') ?? ''}\n        ${subprop?.get('options')?.map(option => option.id).join(', ') ?? ''}\n      `,\n      sector,\n      property,\n    }))\n}\n\n// Main action\nfunction refresh(editor, input, wrapper) {\n  if (input.value) {\n    // Display\n    wrapper.classList.remove('empty')\n    \n    // Get searchable items\n    const properties = getSearchableItems(editor)\n      // Keep only the matching items\n      .filter(item => item.searchable.toLowerCase().includes(input.value.toLowerCase()))\n\n    // Close and hide all sectors and properties\n    getSectors(editor)\n      .forEach(sector => {\n        showSector(sector, false)\n        sector.getProperties()\n        .forEach(property => showProperty(property, false))\n      })\n    // Show the one we are searching for\n    properties.forEach(item => {\n      showSector(item.sector, true)\n      showProperty(item.property, true)\n    })\n  } else {\n    wrapper.classList.add('empty')\n    resetAll(editor)\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","globalThis","window","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_typeof","iterator","constructor","_toPropertyKey","arg","input","hint","prim","toPrimitive","undefined","res","TypeError","String","Number","_defineProperty","configurable","writable","editor","opts","arguments","length","on","options","_objectSpread","placeholder","appendTo","appendBefore","prefix","Config","selectorManager","pStylePrefix","id","concat","container","document","createElement","innerHTML","tags","getContainer","querySelector","wrapper","parentElement","insertBefore","lastElementChild","onkeyup","refresh","onclick","resetAll","setTimeout","getSectors","forEach","sector","item","changedSectors","setOpen","initial","delete","resetSector","getProperties","property","changedProperties","set","resetProperty","WeakMap","showSector","visible","has","isOpen","showProperty","StyleManager","toArray","filter","isVisible","classList","remove","properties","flatMap","getType","map","subprop","_ref","_property$get$map$joi","_property$get","_subprop$get","_subprop$get$map$join","_subprop$get2","searchable","option","join","getSearchableItems","toLowerCase","includes","add"],"sourceRoot":""}